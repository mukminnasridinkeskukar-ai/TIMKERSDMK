<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Command Center SDM Kesehatan | Dinkes Kukar</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root{
  --bg:#020617;
  --panel:#0f172a;
  --panel2:#020617;
  --border:#1e293b;
  --accent:#38bdf8;
  --green:#22c55e;
  --pink:#f472b6;
  --yellow:#facc15;
  --text:#e5e7eb;
  --muted:#94a3b8;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:Inter,Segoe UI,Arial;
  background:linear-gradient(180deg,#020617,#020617);
  color:var(--text);
}
header{
  padding:24px;
  border-bottom:1px solid var(--border);
}
header h1{
  margin:0;
  font-size:24px;
  font-weight:800;
}
header small{
  color:var(--muted);
}
.container{
  max-width:1500px;
  margin:auto;
  padding:24px;
}
.grid{
  display:grid;
  gap:20px;
}
.grid.kpi{
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
}
.grid.main{
  grid-template-columns:2fr 1fr;
}
.grid.sub{
  grid-template-columns:1fr 1fr 1fr;
}
.card, .panel{
  background:linear-gradient(180deg,var(--panel),var(--panel2));
  border:1px solid var(--border);
  border-radius:22px;
  padding:20px;
}
.card h4{
  margin:0;
  font-size:14px;
  color:var(--muted);
}
.card .v{
  margin-top:6px;
  font-size:34px;
  font-weight:800;
}
.panel h3{
  margin:0 0 12px;
  font-size:16px;
  font-weight:700;
}
.insight{
  font-size:14px;
  line-height:1.6;
  color:#cbd5f5;
}
footer{
  text-align:center;
  color:var(--muted);
  font-size:13px;
  padding:24px;
}
@media(max-width:1000px){
  .grid.main,.grid.sub{grid-template-columns:1fr}
}
</style>
</head>

<body>

<header>
  <h1>üõ∞Ô∏è Command Center SDM Kesehatan</h1>
  <small>Dinas Kesehatan Kabupaten Kutai Kartanegara ‚Ä¢ Data Agregat Publik</small>
</header>

<div class="container">

  <!-- KPI -->
  <div class="grid kpi">
    <div class="card"><h4>Total SDM</h4><div class="v" id="k_total">0</div></div>
    <div class="card"><h4>Dokter</h4><div class="v" id="k_dokter">0</div></div>
    <div class="card"><h4>Perawat</h4><div class="v" id="k_perawat">0</div></div>
    <div class="card"><h4>Bidan</h4><div class="v" id="k_bidan">0</div></div>
    <div class="card"><h4>Rasio Dokter</h4><div class="v">‚Äì</div></div>
    <div class="card"><h4>Rasio Perawat</h4><div class="v">‚Äì</div></div>
  </div>

  <!-- GRAFIK UTAMA -->
  <div class="grid main" style="margin-top:26px">
    <div class="panel">
      <h3>Komposisi SDM</h3>
      <canvas id="donut"></canvas>
    </div>
    <div class="panel">
      <h3>Distribusi Tenaga</h3>
      <canvas id="bar"></canvas>
    </div>
  </div>

  <!-- GRAFIK TAMBAHAN -->
  <div class="grid sub" style="margin-top:26px">
    <div class="panel">
      <h3>Tren SDM</h3>
      <canvas id="line"></canvas>
    </div>
    <div class="panel">
      <h3>Perbandingan Tenaga</h3>
      <canvas id="mini"></canvas>
    </div>
    <div class="panel">
      <h3>Insight</h3>
      <div class="insight" id="insight">
        Memuat ringkasan data SDM kesehatan Kabupaten Kutai Kartanegara‚Ä¶
      </div>
    </div>
  </div>

</div>

<footer>
¬© Dinas Kesehatan Kabupaten Kutai Kartanegara
</footer>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbxqZGc0qfI1TgbT76PZEwKK8BkTF86dA1sojKPvHapuRZc9zF1LrUPQkgrggITXppec/exec?page=api";

fetch(API_URL)
.then(r=>r.json())
.then(data=>{
  const sum={Dokter:0,Perawat:0,Bidan:0,"Nakes Lain":0};
  data.forEach(d=>{ if(sum[d.Jenis]!=null) sum[d.Jenis]+=Number(d.Jumlah); });

  const total = Object.values(sum).reduce((a,b)=>a+b,0);

  k_total.textContent=total;
  k_dokter.textContent=sum.Dokter;
  k_perawat.textContent=sum.Perawat;
  k_bidan.textContent=sum.Bidan;

  new Chart(donut,{
    type:"doughnut",
    data:{labels:Object.keys(sum),datasets:[{data:Object.values(sum),
      backgroundColor:["#38bdf8","#22c55e","#f472b6","#facc15"]}]},
    options:{cutout:"65%",plugins:{legend:{position:"bottom"}}}
  });

  new Chart(bar,{
    type:"bar",
    data:{labels:Object.keys(sum),datasets:[{data:Object.values(sum),backgroundColor:"#38bdf8"}]},
    options:{plugins:{legend:{display:false}}}
  });

  new Chart(line,{
    type:"line",
    data:{labels:Object.keys(sum),
      datasets:[{data:Object.values(sum),borderColor:"#38bdf8",tension:.4}]},
    options:{plugins:{legend:{display:false}}}
  });

  new Chart(mini,{
    type:"bar",
    data:{labels:Object.keys(sum),
      datasets:[{data:Object.values(sum),backgroundColor:["#22c55e","#38bdf8","#f472b6","#facc15"]}]},
    options:{plugins:{legend:{display:false}}}
  });

  insight.innerHTML = `
    Total SDM kesehatan saat ini berjumlah <b>${total}</b> orang.
    Komposisi terbesar berasal dari <b>Perawat</b> (${sum.Perawat}),
    diikuti <b>Dokter</b> (${sum.Dokter}) dan <b>Bidan</b> (${sum.Bidan}).
    Data ini menjadi dasar perencanaan kebutuhan SDM ke depan.
  `;
});
</script>

</body>
</html>


