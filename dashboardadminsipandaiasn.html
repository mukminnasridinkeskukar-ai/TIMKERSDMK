<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Dashboard Admin</title>

<style>
body{
  font-family:Segoe UI, Arial;
  background:#eef2f6;
  padding:20px;
}
.container{
  max-width:1200px;
  margin:auto;
  background:#fff;
  padding:25px;
  border-radius:14px;
  box-shadow:0 10px 25px rgba(0,0,0,.08);
}
h2{text-align:center;margin-bottom:20px}
.cards{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:15px;
}
.card{
  background:#f8f9fa;
  padding:20px;
  border-radius:12px;
  text-align:center;
}
.card h3{margin:0;font-size:26px;color:#28a745}
.card p{margin:5px 0 0}

input{
  padding:10px;
  width:300px;
  margin:20px 0;
  border-radius:8px;
  border:1px solid #ccc;
}

table{
  width:100%;
  border-collapse:collapse;
  margin-top:15px;
}
th,td{
  padding:10px;
  border-bottom:1px solid #ddd;
  text-align:left;
}
th{background:#f1f1f1}
</style>
</head>

<body>
<div class="container">

<h2>Dashboard Admin Pendaftaran</h2>

<div class="cards">
  <div class="card">
    <h3 id="total">0</h3>
    <p>Total Pendaftar</p>
  </div>
  <div class="card">
    <h3 id="zoom">0</h3>
    <p>Zoom Meeting</p>
  </div>
  <div class="card">
    <h3 id="youtube">0</h3>
    <p>YouTube</p>
  </div>
</div>

<input type="text" id="search" placeholder="Cari nama / NIP / unit...">

<table>
<thead>
<tr>
  <th>Nama</th>
  <th>NIP</th>
  <th>Unit</th>
  <th>Status</th>
  <th>Jenis SDMK</th>
  <th>Tema</th>
  <th>Platform</th>
</tr>
</thead>
<tbody id="tbody"></tbody>
</table>

</div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwuyn081bnov_swyoCAg1M0QKCpEub6TRtWMEjL16GOmd4baUSImmw2Vo7vEpLBjCbvBg/exec";
let rawData=[];

async function loadData(){
  const res = await fetch(SCRIPT_URL+"?action=admin");
  rawData = await res.json();
  render(rawData);
}
loadData();

function render(data){
  tbody.innerHTML="";
  total.innerText = data.length;

  let zoom=0, yt=0;

  data.forEach(d=>{
    if(d["Platform Digital"]==="Zoom Meeting") zoom++;
    if(d["Platform Digital"]==="YouTube") yt++;

    tbody.innerHTML += `
      <tr>
        <td>${d["Nama Lengkap"]}</td>
        <td>${d["NIP"]}</td>
        <td>${d["Unit Kerja"]}</td>
        <td>${d["Status Pegawai"]}</td>
        <td>${d["Jenis SDMK"]}</td>
        <td>${d["Tema Pembelajaran"]}</td>
        <td>${d["Platform Digital"]}</td>
      </tr>
    `;
  });

  zoom.innerText = zoom;
  youtube.innerText = yt;
}

search.oninput = ()=>{
  const q = search.value.toLowerCase();
  const f = rawData.filter(d =>
    Object.values(d).join(" ").toLowerCase().includes(q)
  );
  render(f);
};
</script>

</body>
</html>
