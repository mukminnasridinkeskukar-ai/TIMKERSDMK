<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Dashboard Peminat SDMK</title>
<meta name="viewport" content="width=device-width,initial-scale=1">

<style>
body{font-family:Segoe UI,Arial;background:#f1f5f9;margin:0}
header{
  background:#0f172a;color:#fff;
  padding:16px 20px;
  display:flex;justify-content:space-between;align-items:center
}
.container{padding:20px}

input{padding:10px;width:260px}

table{width:100%;border-collapse:collapse;background:#fff}
th,td{padding:10px;border-bottom:1px solid #e5e7eb}
th{background:#f8fafc}
tbody tr{cursor:pointer}
tbody tr:hover{background:#f1f5f9}

img.thumb{
  width:44px;height:44px;
  border-radius:50%;object-fit:cover
}

/* MODAL */
.modal{
  position:fixed;inset:0;
  background:rgba(0,0,0,.7);
  display:none;align-items:center;justify-content:center;
  z-index:9999
}
.modal.show{display:flex}
.modal-box{
  background:#fff;
  width:90%;max-width:900px;
  border-radius:18px;
  padding:24px;
  display:grid;
  grid-template-columns:1.4fr 1fr;
  gap:24px
}
.modal-box img{
  width:100%;
  border-radius:16px;
  cursor:zoom-in
}
.close{
  position:absolute;top:14px;right:18px;
  font-size:26px;cursor:pointer
}

/* LIGHTBOX */
.lightbox{
  position:fixed;inset:0;
  background:rgba(0,0,0,.9);
  display:none;align-items:center;justify-content:center;
  z-index:10000
}
.lightbox img{max-width:90%;max-height:90%}
</style>
</head>

<body>

<header>
  <b>ðŸ“Š Dashboard Peminat SDMK</b>
  <button onclick="logout()">Logout</button>
</header>

<div class="container">
  <input id="q" placeholder="Cari nama...">

  <table>
    <thead>
      <tr>
        <th>Foto</th>
        <th>Nama</th>
        <th>JK</th>
        <th>Pendidikan</th>
        <th>Jurusan</th>
      </tr>
    </thead>
    <tbody id="tb"></tbody>
  </table>
</div>

<!-- MODAL -->
<div class="modal" id="modal">
  <div class="modal-box">
    <div>
      <h3 id="mNama"></h3>
      <p><b>Jenis Kelamin:</b> <span id="mJK"></span></p>
      <p><b>Alamat Domisili:</b> <span id="mAlamat"></span></p>
      <p><b>Pendidikan:</b> <span id="mPend"></span></p>
      <p><b>Jurusan / Keahlian:</b> <span id="mJur"></span></p>
    </div>
    <img id="mFoto">
    <span class="close" onclick="closeModal()">Ã—</span>
  </div>
</div>

<!-- LIGHTBOX -->
<div class="lightbox" id="lightbox" onclick="this.style.display='none'">
  <img id="lbImg">
</div>

<script>
const URL = "https://script.google.com/macros/s/AKfycbz35MWnIdotF3DfUFKnK3IrJ4Ln4Kyj3W4BMxpSt9mncdjajKnbKDrDKPfCwY0Mtuue/exec";
let data=[];

fetch(URL).then(r=>r.json()).then(d=>{
  data=d; render();
});

q.oninput=render;

function render(){
  const s=q.value.toLowerCase();
  tb.innerHTML=data
    .filter(r=>r["Nama Lengkap & Gelar"].toLowerCase().includes(s))
    .map(r=>`
      <tr onclick='openModal(${JSON.stringify(r)})'>
        <td><img class="thumb"
          src="https://lh3.googleusercontent.com/d/${r["ID FOTO DRIVE"]}"></td>
        <td>${r["Nama Lengkap & Gelar"]}</td>
        <td>${r["Jenis Kelamin"]}</td>
        <td>${r["Pendidikan"]}</td>
        <td>${r["Jurusan / Keahlian"]}</td>
      </tr>
    `).join("");
}

function openModal(r){
  modal.classList.add("show");
  mNama.textContent=r["Nama Lengkap & Gelar"];
  mJK.textContent=r["Jenis Kelamin"];
  mAlamat.textContent=r["Alamat Domisili"];
  mPend.textContent=r["Pendidikan"];
  mJur.textContent=r["Jurusan / Keahlian"];
  mFoto.src=`https://lh3.googleusercontent.com/d/${r["ID FOTO DRIVE"]}`;
  mFoto.onclick=()=>{
    lbImg.src=mFoto.src;
    lightbox.style.display="flex";
  }
}

function closeModal(){modal.classList.remove("show")}
function logout(){localStorage.clear();location.reload()}
</script>

</body>
</html>
