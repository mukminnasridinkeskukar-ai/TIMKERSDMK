<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Form Pengaduan SDM Kesehatan</title>
<style>
body { font-family: Arial; background:#f0f8ff; padding:20px; }
form { max-width:600px; margin:auto; background:white; padding:20px; border-radius:10px; box-shadow:0 0 15px rgba(0,0,0,0.1);}
label { display:block; margin-top:10px; font-weight:bold; }
input, textarea, select { width:100%; padding:8px; margin-top:5px; border-radius:5px; border:1px solid #ccc; }
textarea { resize:vertical; }
button { margin-top:15px; padding:10px 20px; background:#004080; color:white; border:none; border-radius:5px; cursor:pointer; }
button:hover { background:#0066cc; }
.required { color:red; }
</style>
</head>
<body>

<h2>Form Pengaduan SDM Kesehatan</h2>

<form id="pengaduanForm">
<label>Nama Pelapor <span class="required">*</span></label>
<input type="text" id="nama" required>

<label>Email Pelapor <span class="required">*</span></label>
<input type="email" id="email" required>

<label>Nomor Telepon</label>
<input type="text" id="telp">

<label>Jenis SDM yang Dilaporkan <span class="required">*</span></label>
<select id="jenisSDM" required>
  <option value="">Loading...</option>
</select>

<label>Unit Kerja / Faskes <span class="required">*</span></label>
<input type="text" id="unitKerja" required>

<label>Deskripsi Pengaduan <span class="required">*</span></label>
<textarea id="deskripsi" rows="5" required></textarea>

<label>Apakah ingin anonim?</label>
<select id="anonim">
  <option value="Tidak">Tidak</option>
  <option value="Ya">Ya</option>
</select>

<button type="submit">Kirim Pengaduan</button>
</form>

<script>
const scriptURL = 'https://script.google.com/macros/s/AKfycbxFI3keyTGxuLIAR4Z7jSdKtxNLXXOptbTPAiR0dGD4Fxz3X4AUbscxE8mF6V09nLgU/exec'; // Ganti dengan URL Web App Apps Script

// Load dropdown Jenis SDM dari Sheet
async function loadJenisSDM() {
  try {
    const res = await fetch(scriptURL + "?action=getJenisSDM");
    const data = await res.json();
    const select = document.getElementById('jenisSDM');
    select.innerHTML = '<option value="">Pilih jenis SDM</option>';
    data.forEach(item => {
      const opt = document.createElement('option');
      opt.value = item;
      opt.textContent = item;
      select.appendChild(opt);
    });
  } catch(err) {
    console.error("Gagal load Jenis SDM:", err);
    document.getElementById('jenisSDM').innerHTML = '<option value="">Gagal load Jenis SDM</option>';
  }
}
loadJenisSDM();

// Submit form
document.getElementById('pengaduanForm').addEventListener('submit', async e => {
  e.preventDefault();

  const formData = new FormData();
  formData.append('nama', document.getElementById('nama').value);
  formData.append('email', document.getElementById('email').value);
  formData.append('telp', document.getElementById('telp').value);
  formData.append('jenisSDM', document.getElementById('jenisSDM').value);
  formData.append('unitKerja', document.getElementById('unitKerja').value);
  formData.append('deskripsi', document.getElementById('deskripsi').value);
  formData.append('anonim', document.getElementById('anonim').value);

  fetch(scriptURL, { method: 'POST', body: formData })
    .then(res => res.json())
    .then(data => {
      alert("Pengaduan berhasil dikirim!");
      document.getElementById('pengaduanForm').reset();
      loadJenisSDM();
    })
    .catch(err => {
      console.error(err);
      alert("Terjadi kesalahan. Coba lagi.");
    });
});
</script>

</body>
</html>
