<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8"></meta>
<title>Data PAK Integrasi 2022</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport"></meta>

<style>
body{
  font-family:Segoe UI,Arial,sans-serif;
  background:#f4f7fb;
  margin:0;
}
.container{
  max-width:100%;
  margin:20px auto;
  background:#fff;
  padding:20px;
  border-radius:12px;
  box-shadow:0 8px 20px rgba(0,0,0,.12)
}
h2{text-align:center;margin-bottom:15px}

/* FILTER */
.filters{
  display:flex;
  gap:12px;
  margin-bottom:15px;
  flex-wrap:wrap
}
.filter-box{
  flex:1;
  min-width:260px
}
label{
  font-size:13px;
  font-weight:600;
  display:block;
  margin-bottom:4px
}
input,select{
  width:100%;
  padding:10px;
  border-radius:6px;
  border:1px solid #ccc;
  font-size:14px
}

/* TABLE WRAPPER */
.table-wrap{
  max-height:70vh;
  overflow:auto;
  border:1px solid #ddd;
  border-radius:8px;
}

table{
  border-collapse:separate;
  border-spacing:0;
  font-size:14px;
  table-layout:auto;
  min-width:900px;
}

th,td{
  border:1px solid #ddd;
  padding:8px;
  vertical-align:top;
  word-wrap:break-word;
}

thead th{
  position:sticky;
  top:0;
  background:#0d6efd;
  color:#fff;
  text-align:center;
  z-index:5;
}

/* WARNA KETERANGAN */
.ket-terbit{
  background:#198754;
  color:#fff;
  font-weight:600;
  padding:4px 6px;
  border-radius:4px;
  display:inline-block;
}
.ket-proses{
  background:#ffc107;
  color:#000;
  font-weight:600;
  padding:4px 6px;
  border-radius:4px;
  display:inline-block;
}
.ket-perbaikan{
  background:#dc3545;
  color:#fff;
  font-weight:600;
  padding:4px 6px;
  border-radius:4px;
  display:inline-block;
}
.ket-ditolak{
  background:#000;
  color:#fff;
  font-weight:600;
  padding:4px 6px;
  border-radius:4px;
  display:inline-block;
}

tr:hover{background:#f1f5ff}

.btn{
  background:#0d6efd;
  color:#fff;
  padding:5px 8px;
  border-radius:5px;
  text-decoration:none;
  font-weight:600;
  font-size:13px;
}
.btn:hover{opacity:.85}

.footer{
  text-align:center;
  font-size:13px;
  margin-top:10px;
  color:#666
}
</style>
</head>

<body>
<div class="container">
<h2>DATA PAK INTEGRASI 2022</h2>

<div class="filters">
  <div class="filter-box">
    <label>Cari Nama Lengkap</label>
    <input id="searchNama" placeholder="Ketik nama di sini..." />
  </div>

  <div class="filter-box">
    <label>Filter Keterangan</label>
    <select id="filterKet">
      <option value="">Semua</option>
      <option value="terbit">Terbit</option>
      <option value="proses">Proses</option>
      <option value="perbaikan">Perbaikan</option>
      <option value="ditolak">Ditolak</option>
    </select>
  </div>
</div>

<div class="table-wrap">
<table>
<thead>
<tr>
  <th>Nama Lengkap</th>
  <th>Satuan Kerja</th>
  <th>Keterangan</th>
  <th>Detail Perbaikan</th>
  <th>Download</th>
</tr>
</thead>
<tbody id="tbody">
<tr><td colspan="5">‚è≥ Memuat data...</td></tr>
</tbody>
</table>
</div>

<div class="footer">Sumber Data: Google Sheet PAK Integrasi 2022</div>
</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycby5cQjlXgcigXNYWyZcQ0AmvURO5D_C72nPTZWf2IR1cJfbFpzZX_0R0_inUNfM_-8/exec";
let allData = [];

fetch(API_URL)
.then(r=>r.json())
.then(d=>{
  allData=d;
  render(d);
});

function render(data){
  tbody.innerHTML="";
  if(!data.length){
    tbody.innerHTML="<tr><td colspan='5'>Data tidak ditemukan</td></tr>";
    return;
  }

  data.forEach(d=>{
    let ket = (d["Keterangan"]||"").toLowerCase();
    let cls="ket-proses";
    if(ket.includes("terbit")) cls="ket-terbit";
    else if(ket.includes("perbaikan")) cls="ket-perbaikan";
    else if(ket.includes("ditolak")) cls="ket-ditolak";

    tbody.innerHTML+=`
    <tr>
      <td>${d["Nama Lengkap"]||""}</td>
      <td>${d["Satuan Kerja"]||""}</td>
      <td style="text-align:center">
        <span class="${cls}">${d["Keterangan"]||""}</span>
      </td>
      <td>${d["Detail Perbaikan"]||""}</td>
      <td style="text-align:center">
        ${d["Link Download"]
          ? `<a class="btn" href="${d["Link Download"]}" target="_blank">Download</a>`
          : "-"}
      </td>
    </tr>`;
  });
}

function applyFilter(){
  const q = searchNama.value.toLowerCase();
  const f = filterKet.value.toLowerCase();
  const filtered = allData.filter(d=>{
    const nama = (d["Nama Lengkap"]||"").toLowerCase();
    const ket = (d["Keterangan"]||"").toLowerCase();
    return nama.includes(q) && (f==="" || ket.includes(f));
  });
  render(filtered);
}

searchNama.addEventListener("keyup", applyFilter);
filterKet.addEventListener("change", applyFilter);
</script>
</body>
</html>
